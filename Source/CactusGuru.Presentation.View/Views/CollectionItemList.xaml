<DockPanel x:Class="CactusGuru.Presentation.View.Views.CollectionItemList"
           xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
           xmlns:intr="http://schemas.microsoft.com/expression/2010/interactivity"
           xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
           xmlns:local="clr-namespace:CactusGuru.Presentation.View.Views"
           xmlns:utils="clr-namespace:CactusGuru.Presentation.View.Utils">
    <DockPanel.Resources>
        <local:ViewModelLocator x:Key="vmLocator" />
        <utils:StringVisibilityConverter x:Key="stringVisConverter"/>
    </DockPanel.Resources>
    <DockPanel.DataContext>
        <Binding Source="{StaticResource vmLocator}" Path="CollectionItemListViewModel" />
    </DockPanel.DataContext>
    <intr:Interaction.Triggers>
        <intr:EventTrigger EventName="Loaded">
            <intr:InvokeCommandAction Command="{Binding LoadCommand}"/>
        </intr:EventTrigger>
        <intr:EventTrigger EventName="Unloaded">
            <intr:InvokeCommandAction Command="{Binding UnloadCommand}"/>
        </intr:EventTrigger>
    </intr:Interaction.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <TextBox Text="{Binding CollectionItems.FilterText, UpdateSourceTrigger=PropertyChanged, Delay=400}" Margin="5" Padding="3" Width="250" HorizontalAlignment="Left"/>
        <ListBox Grid.Row="1" ItemsSource="{Binding CollectionItems}" SelectedItem="{Binding SelectedCollectionItem}" AlternationCount="2">
            <ListBox.ContextMenu>
                <ContextMenu>
                    <ContextMenu.Template>
                        <ControlTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Button>کپی</Button>
                                <Button Grid.Column="1" Command="{Binding EditCurrentCollectionItemCommand}">ویرایش</Button>
                                <Button Grid.Row="1" Grid.ColumnSpan="2" Command="{Binding DeleteCurrentCollectionItemCommand}">حذف</Button>
                                <Button Grid.Row="1" Grid.ColumnSpan="2" Command="{Binding CopyNameCommand}">کپی</Button>
                                <Button Grid.Row="2" Grid.ColumnSpan="2" Command="{Binding GotoImageGallaryCommand}">گالری</Button>
                            </Grid>
                        </ControlTemplate>
                    </ContextMenu.Template>
                </ContextMenu>
            </ListBox.ContextMenu>
            <ListBox.ItemContainerStyle>
                <Style>
                    <Style.Triggers>
                        <Trigger Property="ListBox.AlternationIndex" Value="1">
                            <Setter Property="Control.Background" Value="#e9e9ea"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListBox.ItemContainerStyle>
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid Height="35">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="auto"/>
                        </Grid.RowDefinitions>
                        <TextBlock Grid.RowSpan="2" Text="{Binding Code}" FontSize="15" VerticalAlignment="Center" FontWeight="Bold" Margin="0 0 8 0"/>
                        <TextBlock Grid.Column="1" Text="{Binding Name}" FontSize="13" FontWeight="Bold" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding Info}" Visibility="{Binding Info, Converter={StaticResource stringVisConverter}}" FontSize="12"/>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</DockPanel>
